"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3929],{55442:function(e,o,t){t.d(o,{c:function(){return k}});var n=t(52322),s=t(24990),i=t(99959),l=t(5632),a=t(2784),r=t(54383),c=t(11170),d=t(9015),u=t(95392),p=t(750),v=t(55283),h=t(27570),x=t(56006),m=t(37962),f=t(64306),g=t(41679),j=t(44085),b=t(74091),N=t(92575),w=t(82667),_=t(28020),y=t(9109),S=t(57519),C=t(37782),A=t(22379),I=t(13911),P=t(17172),E=t(78232);let T=[{id:"uri",label:"URI"},{id:"psql",label:"PSQL"},{id:"golang",label:"Golang"},{id:"jdbc",label:"JDBC"},{id:"dotnet",label:".NET"},{id:"nodejs",label:"Nodejs"},{id:"php",label:"PHP"},{id:"python",label:"Python"}],k=e=>{var o,t;let{appearance:k}=e,U=(0,l.useRouter)(),R=(0,i.Mk)(),{ref:D,connectionString:Z}=(0,i.UO)(),O=(0,S.mM)(),W=(0,y.TF)(),{project:H,isLoading:q}=(0,h.d2)(),F=null==H?void 0:H.is_read_replicas_enabled,L=(0,a.useRef)(null),[M,z]=(0,a.useState)("session"),[Y,B]=(0,a.useState)("uri"),{data:V,isSuccess:X}=(0,b.Y)({projectRef:D}),Q=F?null==V?void 0:V.find(e=>e.identifier===W.selectedDatabaseId):null==V?void 0:V.find(e=>"PRIMARY"===e.database_type),{data:G,error:J,isLoading:K,isError:$,isSuccess:ee}=(0,j.o)({projectRef:D}),{data:eo,error:et,isLoading:en,isError:es,isSuccess:ei}=(0,N.b)({projectRef:D}),el=(null!=eo?eo:[]).find(e=>e.identifier===W.selectedDatabaseId),{project:ea}=null!=G?G:{},er=["db_host","db_name","db_port","db_user","inserted_at"],ec={db_user:"",db_host:"",db_port:"",db_name:""},ed=F?(0,w.Ff)(el||ec,er):(0,w.Ff)(ea||ec,er),eu=(null==H?void 0:H.restUrl)!==void 0&&null!==(t=new URL(null!==(o=null==H?void 0:H.restUrl)&&void 0!==o?o:"").hostname.split(".").pop())&&void 0!==t?t:"co",ep=e=>{var o;let t=null===(o=T.find(o=>o.id===e))||void 0===o?void 0:o.label;_.Z.sendEvent({category:"settings",action:"copy_connection_string",label:t||""},R,U)},ev=X&&void 0!==Q?(0,I.xI)(ed,Q,{projectRef:D,usePoolerConnection:O.usePoolerConnection}):{uri:"",psql:"",golang:"",jdbc:"",dotnet:"",nodejs:"",php:"",python:""},eh=X&&void 0!==Q?(0,I.Ak)(null==Q?void 0:Q.connectionString):"com",ex=X&&void 0!==Q?(0,I.a4)(null==Q?void 0:Q.connectionString,{selectedTab:Y,usePoolerConnection:O.usePoolerConnection,ref:D,cloudProvider:q?"":(null==ea?void 0:ea.cloud_provider)||"",region:q?"":(null==ea?void 0:ea.region)||"",tld:O.usePoolerConnection?eh:eu,portNumber:O.usePoolerConnection?"transaction"===M?null==Q?void 0:Q.db_port.toString():"5432":ed.db_port.toString()}):[];return(0,a.useEffect)(()=>{if(F&&void 0!==Z&&void 0!==L.current){var e;W.setSelectedDatabaseId(Z),null===(e=L.current)||void 0===e||e.scrollIntoView({block:"center",behavior:"smooth"})}},[Z]),(0,a.useEffect)(()=>{(null==Q?void 0:Q.pool_mode)==="session"&&z(Q.pool_mode)},[null==Q?void 0:Q.pool_mode]),(0,n.jsx)("div",{id:"connection-string",className:"w-full",children:(0,n.jsxs)(f.Z,{className:(0,r.cn)("!m-0 [&>div:nth-child(1)]:!border-0 [&>div:nth-child(1)>div]:!p-0","minimal"===k&&"border-0 shadow-none"),bodyClassName:(0,r.cn)("minimal"===k&&"bg-transparent"),titleClasses:(0,r.cn)("minimal"===k&&"bg-transparent"),title:(0,n.jsxs)("div",{ref:L,className:(0,r.cn)("w-full flex flex-col","default"===k?"pt-4":"pt-0"),children:[(0,n.jsxs)("div",{className:(0,r.cn)("flex items-center justify-between mb-2","default"===k&&"px-6"),children:["default"===k&&(0,n.jsx)("h5",{className:"mb-0",children:"Connection string"},"panel-title"),(0,n.jsxs)("div",{className:(0,r.cn)("flex items-center gap-x-2 ml-auto","minimal"===k?"absolute -top-1 right-0":""),children:[F&&(0,n.jsx)(m.Z,{}),(0,n.jsx)(c.z,{asChild:!0,type:"default",icon:(0,n.jsx)(P.Z,{strokeWidth:1.5}),children:(0,n.jsx)("a",{target:"_blank",href:"https://supabase.com/docs/guides/database/connecting-to-postgres",children:"Documentation"})})]})]}),(0,n.jsx)(d.Z,{type:"underlined",size:"tiny",activeId:Y,baseClassNames:(0,r.cn)("!space-y-0 px-6 -mb-[1px]","minimal"===k&&"-mt-1 px-0"),onChange:B,children:T.map(e=>(0,n.jsx)(d.Z.Panel,{id:e.id,label:e.label},e.id))}),(0,n.jsx)(u.Z,{})]}),children:[(0,n.jsxs)(f.Z.Content,{className:"minimal"===k&&"px-0",children:[(F?en:K)&&(0,n.jsx)(g.Z,{className:"h-8 w-full"}),(F?es:$)&&(0,n.jsx)(x.Z,{error:F?et:J,subject:"Failed to retrieve database settings"}),(F?ei:ee)&&(0,n.jsxs)("div",{className:"flex flex-col gap-y-4 pt-2",children:[(0,n.jsx)(A.K,{id:"connection-string",checked:O.usePoolerConnection,poolingMode:M,onCheckedChange:O.setUsePoolerConnection,onSelectPoolingMode:z}),!O.usePoolerConnection&&(0,n.jsx)(C.X,{}),(0,n.jsx)(p.Z,{copy:!0,readOnly:!0,disabled:!0,className:"input-mono [&>div>div>div>input]:text-xs [&>div>div>div>input]:opacity-100",value:"transaction"===M?ev[Y]:ev[Y].replace("6543","5432"),onCopy:()=>ep(Y)})]})]}),ex.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.Z,{}),(0,n.jsxs)(f.Z.Content,{className:(0,r.cn)("!py-3 space-y-2","minimal"===k&&"px-0"),children:[(0,n.jsxs)(v.zF,{children:[(0,n.jsx)(v.wy,{className:"group [&[data-state=open]>div>svg]:!-rotate-180",children:(0,n.jsxs)("div",{className:"flex items-center gap-x-2 w-full",children:[(0,n.jsx)("p",{className:"text-xs text-foreground-light group-hover:text-foreground transition",children:"How to connect to a different database or switch to another user"}),(0,n.jsx)(E.Z,{className:"transition-transform duration-200",strokeWidth:1.5,size:14})]})}),(0,n.jsx)(v.Fw,{className:"my-2",children:(0,n.jsxs)("div",{className:"text-foreground-light",children:[(0,n.jsxs)("p",{className:"text-xs",children:["You can use the following URI format to switch to a different database or user",O.usePoolerConnection?" when using connection pooling":"","."]}),(0,n.jsx)("p",{className:"text-sm font-mono tracking-tight text-foreground-lighter",children:ex.map((e,o)=>e.tooltip?(0,n.jsxs)(s.fC,{delayDuration:0,children:[(0,n.jsx)(s.xz,{asChild:!0,children:(0,n.jsx)("span",{className:"text-foreground text-xs",children:e.value})}),(0,n.jsx)(s.h_,{children:(0,n.jsx)(s.h_,{children:(0,n.jsxs)(s.VY,{side:"bottom",children:[(0,n.jsx)(s.Eh,{className:"radix-tooltip-arrow"}),(0,n.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,n.jsx)("span",{className:"text-xs text-foreground",children:e.tooltip})})]})})})]},"syntax-".concat(o)):(0,n.jsx)("span",{className:"text-xs",children:e.value},"syntax-".concat(o)))})]})})]}),"python"===Y&&(0,n.jsxs)(v.zF,{children:[(0,n.jsx)(v.wy,{className:"group [&[data-state=open]>div>svg]:!-rotate-180",children:(0,n.jsxs)("div",{className:"flex items-center gap-x-2 w-full",children:[(0,n.jsx)("p",{className:"text-xs text-foreground-light group-hover:text-foreground transition",children:"Connecting to SQL Alchemy"}),(0,n.jsx)(E.Z,{className:"transition-transform duration-200",strokeWidth:1.5,size:14})]})}),(0,n.jsx)(v.Fw,{className:"my-2",children:(0,n.jsxs)("div",{className:"text-foreground-light text-xs grid gap-2",children:[(0,n.jsxs)("p",{children:["Please use ",(0,n.jsx)("code",{children:"postgresql://"})," instead of ",(0,n.jsx)("code",{children:"postgres://"})," as your dialect when connecting via SQLAlchemy."]}),(0,n.jsxs)("p",{children:["Example:",(0,n.jsx)("code",{children:'create_engine("postgresql+psycopg2://...")'})]}),(0,n.jsx)("p",{className:"text-sm font-mono tracking-tight text-foreground-lighter"})]})})]})]})]})]})})}},13911:function(e,o,t){t.d(o,{Ak:function(){return d},a4:function(){return c},xI:function(){return n}});let n=(e,o,t)=>{let n=o.connectionString.includes("options=reference"),{usePoolerConnection:s,projectRef:i}=t,l=s?o.db_user:e.db_user,a=s?null==o?void 0:o.db_port:e.db_port,r=s?o.db_host:e.db_host,c=s?null==o?void 0:o.db_name:e.db_name,d="[YOUR-PASSWORD]",u=s&&n,p=s?null==o?void 0:o.connectionString:"postgresql://".concat(l,":").concat(d,"@")+"".concat(r,":").concat(a)+"/".concat(c),v="user=".concat(l," password=").concat(d," host=").concat(r," port=").concat(a," dbname=").concat(c).concat(u?" options=reference=".concat(i):"");return{psql:n?'psql "postgresql://'.concat(l,":").concat(d,"@").concat(r,":").concat(a,"/").concat(c).concat(s?"?options=reference%3D".concat(i):"",'"'):"psql -h ".concat(r," -p ")+"".concat(a," -d ").concat(c," ")+"-U ".concat(l),uri:p,golang:v,jdbc:"jdbc:postgresql://".concat(r,":").concat(a,"/").concat(c,"?user=").concat(l,"&password=").concat(d).concat(u?"&options=reference%3D".concat(i):""),dotnet:"User Id=".concat(l,";Password=").concat(d,";Server=").concat(r,";Port=").concat(a,";Database=").concat(c,";").concat(u?"Options='reference=".concat(i,"'"):""),nodejs:p,php:v,python:v}},s="Database user (e.g postgres)",i="Database password",l="Database name (e.g postgres)",a="Project's reference ID",r="Port number (Use 5432 if using prepared statements)",c=(e,o)=>{let{selectedTab:t,usePoolerConnection:n,ref:c,cloudProvider:d,region:u,tld:p,portNumber:v}=o,h=e.includes("options=reference"),x=[{value:d.toLocaleLowerCase(),tooltip:"Cloud provider"},{value:"-0-",tooltip:void 0},{value:u,tooltip:"Project's region"},{value:".pooler.supabase.".concat(p),tooltip:void 0}],m=[{value:"db.",tooltip:void 0},{value:c,tooltip:a},{value:".supabase.".concat(p),tooltip:void 0}];return"uri"===t||"nodejs"===t?h?[{value:"postgres://",tooltip:void 0},{value:"[user]",tooltip:s},{value:":",tooltip:void 0},{value:"[password]",tooltip:i},{value:"@",tooltip:void 0},...n?x:m,{value:":",tooltip:void 0},{value:v,tooltip:r},{value:"/",tooltip:void 0},{value:"[db-name]",tooltip:l},...n?[{value:"?options=reference%3D",tooltip:void 0},{value:c,tooltip:a}]:[]]:[{value:"postgres://",tooltip:void 0},{value:"[user]",tooltip:s},...n?[{value:".",tooltip:void 0},{value:c,tooltip:a}]:[],{value:":",tooltip:void 0},{value:"[password]",tooltip:i},{value:"@",tooltip:void 0},...n?x:m,{value:":",tooltip:void 0},{value:v,tooltip:r},{value:"/",tooltip:void 0},{value:"[db-name]",tooltip:l}]:"psql"===t?h?[{value:'psql "postgresql://',tooltip:void 0},{value:"[user]",tooltip:s},{value:":",tooltip:void 0},{value:"[password]",tooltip:i},{value:"@",tooltip:void 0},...n?x:m,{value:":",tooltip:void 0},{value:v,tooltip:r},{value:"/",tooltip:void 0},{value:"[db-name]",tooltip:l},...n?[{value:"?options=reference%3D",tooltip:void 0},{value:c,tooltip:a}]:[]]:[{value:"psql -h ",tooltip:void 0},...n?x:m,{value:" -p ",tooltip:void 0},{value:v,tooltip:r},{value:" -d ",tooltip:void 0},{value:"[db-name]",tooltip:l},{value:" -U ",tooltip:void 0},{value:"[user]",tooltip:s},...n?[{value:".",tooltip:void 0},{value:c,tooltip:a}]:[]]:"golang"===t||"php"===t||"python"===t?h?[{value:"user=",tooltip:void 0},{value:"[user]",tooltip:s},{value:" password=",tooltip:void 0},{value:"[password]",tooltip:i},{value:" host=",tooltip:void 0},...n?x:m,{value:" port=",tooltip:void 0},{value:v,tooltip:r},{value:" dbname=",tooltip:void 0},{value:"[db-name]",tooltip:l},...n?[{value:" options=reference=",tooltip:void 0},{value:c,tooltip:a}]:[]]:[{value:"user=",tooltip:void 0},{value:"[user]",tooltip:s},...n?[{value:".",tooltip:void 0},{value:c,tooltip:a}]:[],{value:" password=",tooltip:void 0},{value:"[password]",tooltip:i},{value:" host=",tooltip:void 0},...n?x:m,{value:" port=",tooltip:void 0},{value:v,tooltip:r},{value:" dbname=",tooltip:void 0},{value:"[db-name]",tooltip:l}]:"jdbc"===t?h?[{value:"jdbc:postgresql://",tooltip:void 0},...n?x:m,{value:":",tooltip:void 0},{value:v,tooltip:r},{value:"/",tooltip:void 0},{value:"[db-name]",tooltip:l},{value:"?user=",tooltip:void 0},{value:"[user]",tooltip:s},{value:"&password=",tooltip:void 0},{value:"[password]",tooltip:i},...n?[{value:"&options=reference%3D",tooltip:void 0},{value:c,tooltip:a}]:[]]:[{value:"jdbc:postgresql://",tooltip:void 0},...n?x:m,{value:":",tooltip:void 0},{value:v,tooltip:r},{value:"/",tooltip:void 0},{value:"[db-name]",tooltip:l},{value:"?user=",tooltip:void 0},{value:"[user]",tooltip:s},...n?[{value:".",tooltip:void 0},{value:c,tooltip:a}]:[],{value:"&password=",tooltip:void 0},{value:"[password]",tooltip:i}]:"dotnet"===t?h?[{value:"User Id=",tooltip:void 0},{value:"[user]",tooltip:s},{value:";Password=",tooltip:void 0},{value:"[password]",tooltip:i},{value:";Server=",tooltip:void 0},...n?x:m,{value:";Port=",tooltip:void 0},{value:v,tooltip:r},{value:";Database=",tooltip:void 0},{value:"[db-name]",tooltip:l},...n?[{value:";Options='reference=",tooltip:void 0},{value:c,tooltip:a},{value:"'",tooltip:void 0}]:[]]:[{value:"User Id=",tooltip:void 0},{value:"[user]",tooltip:s},...n?[{value:".",tooltip:void 0},{value:c,tooltip:a}]:[],{value:";Password=",tooltip:void 0},{value:"[password]",tooltip:i},{value:";Server=",tooltip:void 0},...n?x:m,{value:";Port=",tooltip:void 0},{value:v,tooltip:r},{value:";Database=",tooltip:void 0},{value:"[db-name]",tooltip:l}]:[]},d=e=>{try{return e.split("pooler.supabase.")[1].split(":6543")[0]}catch(e){return"com"}}},37782:function(e,o,t){t.d(o,{X:function(){return r}});var n=t(52322),s=t(95492),i=t(78804),l=t(11170),a=t(32830);let r=()=>(0,n.jsxs)(s.bZ,{variant:"warning",children:[(0,n.jsx)(i.Z,{strokeWidth:2}),(0,n.jsx)(s.Cd,{children:"Direct database access is only available via IPv6-compatible networks or if your project has the IPv4 add on."}),(0,n.jsxs)(s.X,{className:"space-y-3",children:[(0,n.jsxs)("p",{children:["We strongly recommend using ",(0,n.jsx)("span",{className:"text-foreground",children:"connection pooling"})," to connect to your database because it's compatible with both IPv4 and IPv6 networks."]}),(0,n.jsx)("p",{children:"You'll only need to change the connection credentials that you're using in your application to the pooler's connection credentials."}),(0,n.jsx)(l.z,{asChild:!0,type:"default",icon:(0,n.jsx)(a.Z,{strokeWidth:1.5}),children:(0,n.jsx)("a",{href:"https://github.com/orgs/supabase/discussions/17817",target:"_blank",rel:"noreferrer",children:"Learn more"})})]})]})},31875:function(e,o,t){t.d(o,{F:function(){return x}});var n=t(52322),s=t(99959),i=t(60587),l=t(41909),a=t(11170),r=t(32830),c=t(95492),d=t(80435),u=t(27570),p=t(74091),v=t(9109),h=t(57519);let x=()=>{let{ref:e}=(0,s.UO)(),{project:o}=(0,u.d2)(),t=(0,h.mM)(),x=(0,v.TF)(),m=null==o?void 0:o.is_read_replicas_enabled,{data:f}=(0,p.Y)({projectRef:e}),g=m?null==f?void 0:f.find(e=>e.identifier===x.selectedDatabaseId):null==f?void 0:f.find(e=>"PRIMARY"===e.database_type),j=()=>{let e=document.getElementById("connection-pooler");e&&e.scrollIntoView({behavior:"smooth",block:"center"})};return(0,n.jsx)(l.Vq,{open:t.showPoolingModeHelper,onOpenChange:t.setShowPoolingModeHelper,children:(0,n.jsxs)(l.cZ,{hideClose:!0,className:"sm:max-w-4xl",children:[(0,n.jsxs)(l.fK,{className:"pb-0",children:[(0,n.jsx)(l.$N,{children:(0,n.jsxs)("div",{className:"w-full flex items-center justify-between",children:[(0,n.jsx)("p",{className:"text-lg max-w-2xl",children:"Which pooling mode should I use?"}),(0,n.jsx)(a.z,{asChild:!0,type:"default",icon:(0,n.jsx)(r.Z,{strokeWidth:1.5}),children:(0,n.jsx)("a",{href:"https://supabase.com/docs/guides/database/connecting-to-postgres#how-connection-pooling-works",target:"_blank",rel:"noreferrer",children:"Documentation"})})]})}),(0,n.jsx)(l.Be,{className:"text-lg max-w-2xl",children:"A connection pooler is a system (external to Postgres) which manages Postgres connections by allocating connections whenever clients make requests."})]}),(0,n.jsx)(l.P3,{}),(0,n.jsx)(d.U,{className:"px-6 max-w-full [&>h3]:text-sm",content:"\nEach pooling mode handles connections differently.\n\n### Transaction mode\nThis mode is recommended if you are connecting from *serverless environments*. A connection is assigned to the client for the duration of a transaction. Two consecutive transactions from the same client could be executed over two different connections. Some session-based Postgres features such as prepared statements are *not available* with this option.\n\n### Session mode\nThis mode is similar to connecting to your database directly. There is full support for prepared statements in this mode. When a new client connects, a connection is assigned to the client until it disconnects. You *might run into pooler connection limits* since the connection is held till the client disconnects.\n\n### Using session and transaction modes at the same time\n ".concat((null==g?void 0:g.pool_mode)==="transaction"?"You can use the session mode connection string (port 5432) and transaction mode connection string (port 6543) in your application.":"To get the best of both worlds, as a starting point, we recommend using session mode just when you need support for prepared statements and transaction mode in other cases.","\n")}),(null==g?void 0:g.pool_mode)==="session"&&(0,n.jsx)("div",{className:"px-6",children:(0,n.jsxs)(c.bZ,{variant:"warning",children:[(0,n.jsx)(i.Z,{strokeWidth:2}),(0,n.jsx)(c.Cd,{children:"Pooling mode is currently configured to use session mode"}),(0,n.jsxs)(c.X,{children:["To use transaction mode concurrently with session mode, change the pooling mode to transaction first in the"," ",(0,n.jsx)("span",{tabIndex:0,className:"text-foreground cursor-pointer underline underline-offset-2",onClick:()=>{t.setShowPoolingModeHelper(!1),j()},children:"connection pooling settings"}),". After this, you can use transaction mode on port 6543 and session mode on port 5432."]})]})}),(0,n.jsx)(l.cN,{children:(0,n.jsx)(l.GG,{onClick:()=>t.setShowPoolingModeHelper(!1),children:(0,n.jsx)(a.z,{type:"secondary",children:"Close"})})})]})})}},22379:function(e,o,t){t.d(o,{K:function(){return I}});var n=t(52322),s=t(99959),i=t(5632),l=t(2784),a=t(71640),r=t(34503),c=t(11170),d=t(43687),u=t(90488),p=t(95392),v=t(81076),h=t(27570),x=t(41679),m=t(36492),f=t(45101),g=t(31696),j=t(99248);async function b(e,o){let{projectRef:t}=e;if(void 0===t)throw Error("Project ref is required");let{data:n,error:s}=await (0,g.U2)("/platform/projects/{ref}/config/pgbouncer/status",{params:{path:{ref:t}}});if(s)throw s;return n}let N=function(e){let{projectRef:o}=e,{enabled:t,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,m.a)(f.U.pgBouncerStatus(o),e=>{let{signal:t}=e;return b({projectRef:o},t)},{enabled:t&&j.Qy&&void 0!==o,...n})};var w=t(44085),_=t(74091),y=t(9109),S=t(57519),C=t(39097),A=t.n(C);let I=e=>{let{id:o,checked:t,poolingMode:m="transaction",onCheckedChange:f,onSelectPoolingMode:g}=e,j=(0,i.useRouter)(),[b,C]=(0,l.useState)(!1),{ref:I}=(0,s.UO)(),{project:P}=(0,h.d2)(),E=(0,S.mM)(),T=(0,y.TF)(),{data:k,isLoading:U,isSuccess:R}=(0,_.Y)({projectRef:I}),{data:D,isSuccess:Z}=(0,w.o)({projectRef:I}),{data:O}=N({projectRef:I}),W=j.pathname.endsWith("/settings/database"),H=(null==P?void 0:P.is_read_replicas_enabled)?null==k?void 0:k.find(e=>e.identifier===T.selectedDatabaseId):null==k?void 0:k.find(e=>"PRIMARY"===e.database_type),q=(null==D?void 0:D.project.db_ip_addr_config)==="ipv6",F=e=>{g(e),C(!1)};return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:"flex flex-col gap-y-1",children:(0,n.jsxs)("div",{className:"flex gap-x-3",children:[(0,n.jsx)(a.X,{id:"use-pooler-".concat(o),checked:t,onCheckedChange:()=>f(!t)}),(0,n.jsx)("div",{className:"-mt-[2px] flex flex-col gap-y-1 w-full",children:(0,n.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,n.jsx)("label",{htmlFor:"use-pooler-".concat(o),className:"text-sm cursor-pointer",children:"Display connection pooler"}),t&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[U&&(0,n.jsx)(x.Z,{className:"w-[100px] py-2.5"}),R&&(0,n.jsx)("div",{className:"flex items-center gap-x-1",children:(0,n.jsxs)(r.h_,{open:b,onOpenChange:C,children:[(0,n.jsx)(r.$F,{asChild:!0,children:(0,n.jsx)(c.z,{type:"outline",className:"py-0.5 pr-1.5",iconRight:(0,n.jsx)(d.Z,{strokeWidth:1}),children:(0,n.jsxs)("span",{className:"capitalize",children:["Mode: ",m]})})}),(0,n.jsxs)(r.AW,{side:"bottom",align:"start",className:"w-[280px]",children:[(0,n.jsxs)(r.Xi,{className:"flex items-center justify-between",onClick:()=>F("session"),children:[(0,n.jsx)("span",{children:"Session mode"}),"session"===m&&(0,n.jsx)(u.Z,{className:"text-brand"})]},"session"),(null==H?void 0:H.pool_mode)==="transaction"&&(0,n.jsxs)(r.Xi,{className:"flex items-center justify-between",onClick:()=>F("transaction"),children:[(0,n.jsx)("span",{children:"Transaction mode"}),"transaction"===m&&(0,n.jsx)(u.Z,{className:"text-brand"})]},"transaction"),(null==H?void 0:H.pool_mode)==="session"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.Z,{className:"my-1"}),(0,n.jsxs)("div",{className:"px-2 text-xs flex flex-col gap-y-2",children:[(0,n.jsxs)("p",{children:["To use transaction mode, change the pool mode in the"," ",W?(0,n.jsx)("span",{tabIndex:0,className:"underline hover:text-foreground cursor-pointer transition",onClick:()=>{let e=document.getElementById("connection-pooler");e&&(C(!1),e.scrollIntoView({behavior:"smooth",block:"center"}))},children:"pooling configuration settings"}):(0,n.jsx)(A(),{href:"/project/".concat(I,"/settings/database#connection-pooler"),className:"underline hover:text-foreground",children:"pooling configuration settings"})," ","to use transaction mode first."]}),(0,n.jsx)("p",{children:"You can then connect to session mode on port 5432 and transaction mode on port 6543."})]})]}),(0,n.jsx)(p.Z,{className:"my-1"}),(0,n.jsx)(r.Xi,{onClick:()=>{C(!1),E.setShowPoolingModeHelper(!0)},children:"How to choose pooling modes?"},"more-info")]})]})})]})})]}),(0,n.jsxs)("div",{className:"flex items-center gap-x-1",children:[R&&t&&(0,n.jsx)(v.C,{children:"Supavisor"}),Z&&(0,n.jsx)(v.C,{children:t?"Resolves to IPv4":q?"Resolves to IPv6":"Will resolve to IPv6"}),(null==O?void 0:O.active)&&(0,n.jsx)(v.C,{variant:"warning",children:"PgBouncer pending removal"})]})]})})]})})})}},75951:function(e,o,t){t.d(o,{B:function(){return l},F2:function(){return r},Y4:function(){return i},_J:function(){return c},dA:function(){return d},hV:function(){return u},hk:function(){return a},nK:function(){return s},q_:function(){return p}});var n=t(99248);let s=660,i=50,l=20,a={...n.S,INIT_READ_REPLICA:"INIT_READ_REPLICA",INIT_READ_REPLICA_FAILED:"INIT_READ_REPLICA_FAILED"},r={SOUTHEAST_ASIA:[103.8,1.37],NORTHEAST_ASIA:[139.42,35.41],NORTHEAST_ASIA_2:[126.98,37.56],CENTRAL_CANADA:[-73.6,45.5],WEST_US:[-121.96,37.35],EAST_US:[-78.45,38.13],WEST_EU:[-8,53],WEST_EU_2:[-.1,51],CENTRAL_EU:[8,50],SOUTH_ASIA:[72.88,19.08],OCEANIA:[151.2,-33.86],SOUTH_AMERICA:[-46.38,-23.34]},c={SOUTHEAST_ASIA:[103.8,1.37]},d={SOUTHEAST_ASIA:"ap-southeast-1",NORTHEAST_ASIA:"ap-northeast-1",NORTHEAST_ASIA_2:"ap-northeast-2",CENTRAL_CANADA:"ca-central-1",WEST_US:"us-west-1",EAST_US:"us-east-1",WEST_EU:"eu-west-1",WEST_EU_2:"eu-west-2",CENTRAL_EU:"eu-central-1",SOUTH_ASIA:"ap-south-1",OCEANIA:"ap-southeast-2",SOUTH_AMERICA:"sa-east-1"},u={SOUTHEAST_ASIA:"sin"},p=Object.keys(n.Wp).map(e=>({key:e,name:null===n.Wp||void 0===n.Wp?void 0:n.Wp[e],region:d[e],coordinates:r[e]})).filter(e=>void 0!==e.coordinates)},37962:function(e,o,t){var n=t(52322),s=t(99959),i=t(34291),l=t.n(i),a=t(39097),r=t.n(a),c=t(5632),d=t(2784),u=t(61786),p=t(11170),v=t(54383),h=t(84447),x=t(43687),m=t(90504),f=t(90488),g=t(19869),j=t(2322),b=t(31654),N=t(92575),w=t(89523),_=t(9109),y=t(76141),S=t(75951),C=t(80435);o.Z=e=>{var o;let{variant:t="regular",additionalOptions:i=[],onSelectId:a=l()}=e,A=(0,c.useRouter)(),{ref:I}=(0,s.UO)(),[P,E]=(0,d.useState)(!1),T=(0,_.TF)(),k=T.selectedDatabaseId,{data:U,isLoading:R,isSuccess:D}=(0,N.b)({projectRef:I}),Z=null!=U?U:[],O=Z.sort((e,o)=>e.inserted_at>o.inserted_at?1:0).sort(e=>e.identifier===I?-1:0),W=Z.find(e=>e.identifier===k),H=(0,w.f)(null!==(o=null==W?void 0:W.region)&&void 0!==o?o:""),q=(0,w.U)(null!=k?k:""),F=i.find(e=>e.id===k);return(0,n.jsxs)(u.J2,{open:P,onOpenChange:E,modal:!1,children:[(0,n.jsx)(u.xo,{asChild:!0,children:(0,n.jsx)("div",{className:"flex items-center space-x-2 cursor-pointer",children:(0,n.jsxs)(p.z,{type:"default",className:(0,v.cn)("pr-2","connected-on-right"===t&&"rounded-r-none","connected-on-left"===t&&"rounded-l-none border-l-0","connected-on-both"===t&&"rounded-none border-x-0"),icon:R&&(0,n.jsx)(h.Z,{className:"animate-spin"}),iconRight:(0,n.jsx)(x.Z,{className:"text-foreground-light",strokeWidth:2,size:12}),children:["Source:"," ",F?(0,n.jsx)("span",{children:F.name}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"capitalize",children:R||(null==W?void 0:W.identifier)===I?"Primary database":"Read replica"})," ",D&&(null==W?void 0:W.identifier)!==I&&(0,n.jsxs)("span",{children:["(",H," - ",q,")"]})]})]})})}),(0,n.jsx)(u.yk,{className:"p-0 w-64",side:"bottom",align:"end",children:(0,n.jsx)(m.mY,{children:(0,n.jsxs)(m.e8,{children:[i.length>0&&(0,n.jsx)(m.fu,{className:"border-b",children:i.map(e=>(0,n.jsx)(m.di,{value:e.id,className:"cursor-pointer w-full",onSelect:()=>{T.setSelectedDatabaseId(e.id),E(!1)},onClick:()=>{T.setSelectedDatabaseId(e.id),E(!1)},children:(0,n.jsxs)("div",{className:"w-full flex items-center justify-between",children:[(0,n.jsx)("p",{children:e.name}),e.id===k&&(0,n.jsx)(f.Z,{})]})},e.id))}),(0,n.jsx)(m.fu,{children:(0,n.jsx)(g.x,{className:(Z||[]).length>7?"h-[210px]":"",children:null==O?void 0:O.map(e=>{let o=(0,w.f)(e.region),t=(0,w.U)(e.identifier);if("ACTIVE_HEALTHY"!==e.status){let s=[S.hk.INIT_READ_REPLICA,S.hk.COMING_UP].includes(e.status)?"coming up":"not healthy";return(0,n.jsxs)(j.u,{children:[(0,n.jsx)(j.aJ,{asChild:!0,children:(0,n.jsx)("div",{className:"px-2 py-1.5 w-full flex items-center justify-between",children:(0,n.jsxs)("p",{className:"text-xs text-foreground-lighter",children:["Read replica (",o," - ",t,")"]})})}),(0,n.jsx)(j._v,{side:"right",className:"w-80",children:(0,n.jsx)(C.U,{className:"text-xs text-foreground",content:"Replica unable to accept requests as its ".concat(s,". [View infrastructure settings](/project/").concat(I,"/settings/infrastructure) for more information.")})})]},e.identifier)}return(0,n.jsx)(m.di,{value:e.identifier,className:"cursor-pointer w-full",onSelect:()=>{T.setSelectedDatabaseId(e.identifier),E(!1),a(e.identifier)},onClick:()=>{T.setSelectedDatabaseId(e.identifier),E(!1),a(e.identifier)},children:(0,n.jsxs)("div",{className:"w-full flex items-center justify-between",children:[(0,n.jsx)("p",{children:e.identifier===I?"Primary database":"Read replica (".concat(o," - ").concat(t,")")}),e.identifier===k&&(0,n.jsx)(y.Z,{size:16})]})},e.identifier)})})}),(0,n.jsx)(m.fu,{className:"border-t",children:(0,n.jsx)(m.di,{className:"cursor-pointer w-full",onSelect:()=>{E(!1),A.push("/project/".concat(I,"/settings/infrastructure"))},onClick:()=>E(!1),children:(0,n.jsxs)(r(),{href:"/project/".concat(I,"/settings/infrastructure"),onClick:()=>E(!1),className:"w-full flex items-center gap-2",children:[(0,n.jsx)(b.Z,{size:14,strokeWidth:1.5}),(0,n.jsx)("p",{children:"Create a new read replica"})]})})})]})})})]})}},22329:function(e,o,t){t.d(o,{A:function(){return n}});let n={backups:e=>[e,"database","backups"],poolingConfiguration:e=>[e,"database","pooling-configuration"],indexesFromQuery:(e,o)=>["projects",e,"indexes",{query:o}],indexAdvisorFromQuery:(e,o)=>["projects",e,"index-advisor",{query:o}]}},74091:function(e,o,t){t.d(o,{Y:function(){return a}});var n=t(36492),s=t(31696),i=t(22329);async function l(e,o){let{projectRef:t}=e;if(!t)throw Error("Project ref is required");let{data:n,error:i}=await (0,s.U2)("/platform/projects/{ref}/config/supavisor",{params:{path:{ref:t}},signal:o});return i&&(0,s.S3)(i),n}let a=function(e){let{projectRef:o}=e,{enabled:t=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.a)(i.A.poolingConfiguration(o),e=>{let{signal:t}=e;return l({projectRef:o},t)},{enabled:t&&void 0!==o,...s})}},56302:function(e,o,t){t.d(o,{Z:function(){return n}});let n={list:e=>["project",e,"replicas"],statuses:e=>["project",e,"replicas-statuses"],loadBalancers:e=>["project",e,"load-balancers"]}},92575:function(e,o,t){t.d(o,{b:function(){return c}});var n=t(36492),s=t(31696),i=t(31779),l=t(56302),a=t(99959);async function r(e,o){let{projectRef:t}=e;if(!t)throw Error("Project ref is required");let{data:n,error:i}=await (0,s.U2)("/platform/projects/{ref}/databases",{params:{path:{ref:t}},signal:o});if(i)throw i;return n}let c=function(e){let{projectRef:o}=e,{enabled:t=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:c}=(0,i.ix)({ref:o});return(0,n.a)(l.Z.list(o),e=>{let{signal:t}=e;return r({projectRef:o},t)},{enabled:t&&a.Qy&&(null==c?void 0:c.is_read_replicas_enabled)&&void 0!==o,...s})}},89523:function(e,o,t){t.d(o,{U:function(){return l},f:function(){return a}});var n=t(75951),s=t(56974),i=t.n(s);let l=e=>{var o;return i()(null!==(o=e.split("-"))&&void 0!==o?o:[])},a=e=>{var o,t;return null===(o=i()(null===(t=n.q_.find(o=>o.region===e))||void 0===t?void 0:t.name.split("(")))||void 0===o?void 0:o.split(")")[0]}},57519:function(e,o,t){t.d(o,{mM:function(){return a}}),t(52322);var n=t(2784),s=t(9162),i=t(4741);t(99959);let l=(0,n.createContext)(function(){let e=(0,s.sj)({usePoolerConnection:!0,setUsePoolerConnection:o=>{e.usePoolerConnection=o},showPoolingModeHelper:!1,setShowPoolingModeHelper:o=>{e.showPoolingModeHelper=o}});return e}());function a(e){let o=(0,n.useContext)(l);return(0,i.R)(o,e)}}}]);